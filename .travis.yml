language: node_js

cache: yarn

install: yarn install --ignore-engines

script:
  - yarn test:coverage
  - yarn lint:check
  - yarn format:check

after_success: yarn run coveralls < ./coverage/lcov.info

stages:
  - test

matrix:
  include:
    - os: linux
      node_js: node
    - os: linux
      node_js: "lts/*"
    - os: osx
      node_js: node
    - os: osx
      node_js: "lts/*"
    - os: windows
      # Fix for build timeouts on Windows: https://travis-ci.community/t/timeout-after-build-finished-and-succeeded/1336/2
      env: YARN_GPG=no
      before_install:
        - ./scripts/disable-windows-defender-realtime-monitor
        - ./scripts/install-latest-openssl
      node_js: latest
    - os: windows
      env: YARN_GPG=no
      before_install:
        - ./scripts/disable-windows-defender-realtime-monitor
        - ./scripts/install-latest-openssl
      node_js: lts
